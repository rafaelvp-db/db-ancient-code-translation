# Databricks Ancient Code Translation

![forthebadge](data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNjEuOTYwMDAwMDAwMDAwMDQiIGhlaWdodD0iMzUiIHZpZXdCb3g9IjAgMCAyNjEuOTYwMDAwMDAwMDAwMDQgMzUiPjxyZWN0IGNsYXNzPSJzdmdfX3JlY3QiIHg9IjAiIHk9IjAiIHdpZHRoPSIxNDQuNiIgaGVpZ2h0PSIzNSIgZmlsbD0iIzAwMDAwMCIvPjxyZWN0IGNsYXNzPSJzdmdfX3JlY3QiIHg9IjE0Mi42IiB5PSIwIiB3aWR0aD0iMTE5LjM2MDAwMDAwMDAwMDAxIiBoZWlnaHQ9IjM1IiBmaWxsPSIjRUNCRDA5Ii8+PHBhdGggY2xhc3M9InN2Z19fdGV4dCIgZD0iTTE1LjcwIDIyTDE0LjIyIDIyTDE0LjIyIDEzLjQ3TDE1LjcwIDEzLjQ3TDE1LjcwIDE3LjAyTDE5LjUxIDE3LjAyTDE5LjUxIDEzLjQ3TDIwLjk5IDEzLjQ3TDIwLjk5IDIyTDE5LjUxIDIyTDE5LjUxIDE4LjIxTDE1LjcwIDE4LjIxTDE1LjcwIDIyWk0yNS42MCAxOS4xNkwyNS42MCAxOS4xNkwyNS42MCAxMy40N0wyNy4wNyAxMy40N0wyNy4wNyAxOS4xOFEyNy4wNyAyMC4wMyAyNy41MSAyMC40OFEyNy45NCAyMC45MyAyOC43OCAyMC45M0wyOC43OCAyMC45M1EzMC40OSAyMC45MyAzMC40OSAxOS4xM0wzMC40OSAxOS4xM0wzMC40OSAxMy40N0wzMS45NyAxMy40N0wzMS45NyAxOS4xN1EzMS45NyAyMC41MyAzMS4xMCAyMS4zMlEzMC4yMyAyMi4xMiAyOC43OCAyMi4xMkwyOC43OCAyMi4xMlEyNy4zMiAyMi4xMiAyNi40NiAyMS4zM1EyNS42MCAyMC41NSAyNS42MCAxOS4xNlpNMzYuMzAgMTguMTNMMzYuMzAgMTguMTNMMzYuMzAgMTcuNDZRMzYuMzAgMTUuNTMgMzcuMjIgMTQuNDRRMzguMTUgMTMuMzUgMzkuODEgMTMuMzVMMzkuODEgMTMuMzVRNDEuMjMgMTMuMzUgNDIuMDcgMTQuMDVRNDIuOTAgMTQuNzYgNDMuMDcgMTYuMDhMNDMuMDcgMTYuMDhMNDEuNjIgMTYuMDhRNDEuMzggMTQuNTQgMzkuODMgMTQuNTRMMzkuODMgMTQuNTRRMzguODQgMTQuNTQgMzguMzIgMTUuMjZRMzcuODAgMTUuOTggMzcuNzggMTcuMzdMMzcuNzggMTcuMzdMMzcuNzggMTguMDJRMzcuNzggMTkuNDAgMzguMzcgMjAuMTdRMzguOTUgMjAuOTMgMzkuOTkgMjAuOTNMMzkuOTkgMjAuOTNRNDEuMTIgMjAuOTMgNDEuNjAgMjAuNDJMNDEuNjAgMjAuNDJMNDEuNjAgMTguNzVMMzkuODUgMTguNzVMMzkuODUgMTcuNjJMNDMuMDggMTcuNjJMNDMuMDggMjAuODlRNDIuNjIgMjEuNTAgNDEuODAgMjEuODFRNDAuOTggMjIuMTIgMzkuOTMgMjIuMTJMMzkuOTMgMjIuMTJRMzguODYgMjIuMTIgMzguMDQgMjEuNjNRMzcuMjEgMjEuMTQgMzYuNzYgMjAuMjRRMzYuMzEgMTkuMzMgMzYuMzAgMTguMTNaTTQ3LjQ1IDE4LjEzTDQ3LjQ1IDE4LjEzTDQ3LjQ1IDE3LjQ2UTQ3LjQ1IDE1LjUzIDQ4LjM4IDE0LjQ0UTQ5LjMwIDEzLjM1IDUwLjk2IDEzLjM1TDUwLjk2IDEzLjM1UTUyLjM5IDEzLjM1IDUzLjIyIDE0LjA1UTU0LjA2IDE0Ljc2IDU0LjIzIDE2LjA4TDU0LjIzIDE2LjA4TDUyLjc4IDE2LjA4UTUyLjUzIDE0LjU0IDUwLjk5IDE0LjU0TDUwLjk5IDE0LjU0UTQ5Ljk5IDE0LjU0IDQ5LjQ4IDE1LjI2UTQ4Ljk2IDE1Ljk4IDQ4Ljk0IDE3LjM3TDQ4Ljk0IDE3LjM3TDQ4Ljk0IDE4LjAyUTQ4Ljk0IDE5LjQwIDQ5LjUyIDIwLjE3UTUwLjExIDIwLjkzIDUxLjE0IDIwLjkzTDUxLjE0IDIwLjkzUTUyLjI4IDIwLjkzIDUyLjc2IDIwLjQyTDUyLjc2IDIwLjQyTDUyLjc2IDE4Ljc1TDUxLjAwIDE4Ljc1TDUxLjAwIDE3LjYyTDU0LjI0IDE3LjYyTDU0LjI0IDIwLjg5UTUzLjc3IDIxLjUwIDUyLjk1IDIxLjgxUTUyLjEzIDIyLjEyIDUxLjA5IDIyLjEyTDUxLjA5IDIyLjEyUTUwLjAyIDIyLjEyIDQ5LjE5IDIxLjYzUTQ4LjM3IDIxLjE0IDQ3LjkyIDIwLjI0UTQ3LjQ3IDE5LjMzIDQ3LjQ1IDE4LjEzWk02MC40MiAyMkw1OC45NCAyMkw1OC45NCAxMy40N0w2MC40MiAxMy40N0w2MC40MiAyMlpNNjYuNzEgMjJMNjUuMjMgMjJMNjUuMjMgMTMuNDdMNjYuNzEgMTMuNDdMNzAuNTMgMTkuNTRMNzAuNTMgMTMuNDdMNzIuMDAgMTMuNDdMNzIuMDAgMjJMNzAuNTEgMjJMNjYuNzEgMTUuOTVMNjYuNzEgMjJaTTc2LjQ5IDE4LjEzTDc2LjQ5IDE4LjEzTDc2LjQ5IDE3LjQ2UTc2LjQ5IDE1LjUzIDc3LjQyIDE0LjQ0UTc4LjM0IDEzLjM1IDgwLjAwIDEzLjM1TDgwLjAwIDEzLjM1UTgxLjQyIDEzLjM1IDgyLjI2IDE0LjA1UTgzLjEwIDE0Ljc2IDgzLjI3IDE2LjA4TDgzLjI3IDE2LjA4TDgxLjgyIDE2LjA4UTgxLjU3IDE0LjU0IDgwLjAzIDE0LjU0TDgwLjAzIDE0LjU0UTc5LjAzIDE0LjU0IDc4LjUyIDE1LjI2UTc4LjAwIDE1Ljk4IDc3Ljk4IDE3LjM3TDc3Ljk4IDE3LjM3TDc3Ljk4IDE4LjAyUTc3Ljk4IDE5LjQwIDc4LjU2IDIwLjE3UTc5LjE0IDIwLjkzIDgwLjE4IDIwLjkzTDgwLjE4IDIwLjkzUTgxLjMyIDIwLjkzIDgxLjgwIDIwLjQyTDgxLjgwIDIwLjQyTDgxLjgwIDE4Ljc1TDgwLjA0IDE4Ljc1TDgwLjA0IDE3LjYyTDgzLjI4IDE3LjYyTDgzLjI4IDIwLjg5UTgyLjgxIDIxLjUwIDgxLjk5IDIxLjgxUTgxLjE3IDIyLjEyIDgwLjEzIDIyLjEyTDgwLjEzIDIyLjEyUTc5LjA2IDIyLjEyIDc4LjIzIDIxLjYzUTc3LjQwIDIxLjE0IDc2Ljk2IDIwLjI0UTc2LjUxIDE5LjMzIDc2LjQ5IDE4LjEzWk05NS4zNSAyMkw5My44NyAyMkw5My44NyAxMy40N0w5OS4yOSAxMy40N0w5OS4yOSAxNC42Nkw5NS4zNSAxNC42Nkw5NS4zNSAxNy4yMEw5OC43OSAxNy4yMEw5OC43OSAxOC4zOEw5NS4zNSAxOC4zOEw5NS4zNSAyMlpNMTA0LjIzIDIyTDEwMi42OSAyMkwxMDUuOTEgMTMuNDdMMTA3LjI0IDEzLjQ3TDExMC40NyAyMkwxMDguOTIgMjJMMTA4LjIyIDIwLjAxTDEwNC45MiAyMC4wMUwxMDQuMjMgMjJaTTEwNi41NyAxNS4yOEwxMDUuMzQgMTguODJMMTA3LjgxIDE4LjgyTDEwNi41NyAxNS4yOFpNMTE0LjE1IDE4LjE5TDExNC4xNSAxOC4xOUwxMTQuMTUgMTcuMzlRMTE0LjE1IDE2LjE5IDExNC41OCAxNS4yN1ExMTUuMDEgMTQuMzUgMTE1LjgxIDEzLjg1UTExNi42MSAxMy4zNSAxMTcuNjYgMTMuMzVMMTE3LjY2IDEzLjM1UTExOS4wNyAxMy4zNSAxMTkuOTMgMTQuMTJRMTIwLjc5IDE0Ljg5IDEyMC45MyAxNi4yOUwxMjAuOTMgMTYuMjlMMTE5LjQ2IDE2LjI5UTExOS4zNSAxNS4zNyAxMTguOTIgMTQuOTZRMTE4LjQ5IDE0LjU1IDExNy42NiAxNC41NUwxMTcuNjYgMTQuNTVRMTE2LjY5IDE0LjU1IDExNi4xNyAxNS4yNlExMTUuNjUgMTUuOTYgMTE1LjY0IDE3LjMzTDExNS42NCAxNy4zM0wxMTUuNjQgMTguMDlRMTE1LjY0IDE5LjQ3IDExNi4xNCAyMC4yMFExMTYuNjMgMjAuOTIgMTE3LjU5IDIwLjkyTDExNy41OSAyMC45MlExMTguNDYgMjAuOTIgMTE4LjkwIDIwLjUzUTExOS4zNCAyMC4xNCAxMTkuNDYgMTkuMjJMMTE5LjQ2IDE5LjIyTDEyMC45MyAxOS4yMlExMjAuODEgMjAuNTkgMTE5LjkzIDIxLjM1UTExOS4wNSAyMi4xMiAxMTcuNTkgMjIuMTJMMTE3LjU5IDIyLjEyUTExNi41NyAyMi4xMiAxMTUuNzkgMjEuNjNRMTE1LjAyIDIxLjE1IDExNC41OSAyMC4yNlExMTQuMTcgMTkuMzcgMTE0LjE1IDE4LjE5Wk0xMzAuODIgMjJMMTI1LjI1IDIyTDEyNS4yNSAxMy40N0wxMzAuNzggMTMuNDdMMTMwLjc4IDE0LjY2TDEyNi43MyAxNC42NkwxMjYuNzMgMTcuMDJMMTMwLjIzIDE3LjAyTDEzMC4yMyAxOC4xOUwxMjYuNzMgMTguMTlMMTI2LjczIDIwLjgyTDEzMC44MiAyMC44MkwxMzAuODIgMjJaIiBmaWxsPSIjRkZGRkZGIi8+PHBhdGggY2xhc3M9InN2Z19fdGV4dCIgZD0iTTE1Ni4yMCAyMS4yNEwxNTYuMjAgMjEuMjRMMTU2Ljk4IDE5LjQ5UTE1Ny41NCAxOS44NiAxNTguMjkgMjAuMDlRMTU5LjAzIDIwLjMyIDE1OS43NSAyMC4zMkwxNTkuNzUgMjAuMzJRMTYxLjEyIDIwLjMyIDE2MS4xMiAxOS42NEwxNjEuMTIgMTkuNjRRMTYxLjEyIDE5LjI4IDE2MC43MyAxOS4xMVExNjAuMzQgMTguOTMgMTU5LjQ4IDE4Ljc0TDE1OS40OCAxOC43NFExNTguNTMgMTguNTMgMTU3Ljg5IDE4LjMwUTE1Ny4yNiAxOC4wNiAxNTYuODAgMTcuNTVRMTU2LjM1IDE3LjAzIDE1Ni4zNSAxNi4xNkwxNTYuMzUgMTYuMTZRMTU2LjM1IDE1LjM5IDE1Ni43NyAxNC43N1ExNTcuMTkgMTQuMTUgMTU4LjAyIDEzLjc5UTE1OC44NiAxMy40MyAxNjAuMDYgMTMuNDNMMTYwLjA2IDEzLjQzUTE2MC44OSAxMy40MyAxNjEuNzAgMTMuNjJRMTYyLjUwIDEzLjgwIDE2My4xMiAxNC4xN0wxNjMuMTIgMTQuMTdMMTYyLjM4IDE1LjkzUTE2MS4xOCAxNS4yOCAxNjAuMDUgMTUuMjhMMTYwLjA1IDE1LjI4UTE1OS4zNCAxNS4yOCAxNTkuMDIgMTUuNDlRMTU4LjcwIDE1LjcwIDE1OC43MCAxNi4wNEwxNTguNzAgMTYuMDRRMTU4LjcwIDE2LjM3IDE1OS4wOCAxNi41NFExNTkuNDcgMTYuNzEgMTYwLjMyIDE2Ljg5TDE2MC4zMiAxNi44OVExNjEuMjggMTcuMTAgMTYxLjkxIDE3LjMzUTE2Mi41NCAxNy41NiAxNjMuMDAgMTguMDdRMTYzLjQ2IDE4LjU4IDE2My40NiAxOS40NkwxNjMuNDYgMTkuNDZRMTYzLjQ2IDIwLjIxIDE2My4wNCAyMC44M1ExNjIuNjIgMjEuNDQgMTYxLjc4IDIxLjgwUTE2MC45NCAyMi4xNyAxNTkuNzQgMjIuMTdMMTU5Ljc0IDIyLjE3UTE1OC43MiAyMi4xNyAxNTcuNzYgMjEuOTJRMTU2LjgwIDIxLjY3IDE1Ni4yMCAyMS4yNFpNMTY5LjgzIDE1LjQ4TDE2Ny4yNSAxNS40OEwxNjcuMjUgMTMuNjBMMTc0Ljc3IDEzLjYwTDE3NC43NyAxNS40OEwxNzIuMjAgMTUuNDhMMTcyLjIwIDIyTDE2OS44MyAyMkwxNjkuODMgMTUuNDhaTTE4MC41NiAyMkwxNzguMTMgMjJMMTgxLjg0IDEzLjYwTDE4NC4xOSAxMy42MEwxODcuOTAgMjJMMTg1LjQzIDIyTDE4NC43NyAyMC4zN0wxODEuMjIgMjAuMzdMMTgwLjU2IDIyWk0xODMuMDAgMTUuOTNMMTgxLjkxIDE4LjYxTDE4NC4wNyAxOC42MUwxODMuMDAgMTUuOTNaTTE5NC40MyAyMkwxOTIuMDYgMjJMMTkyLjA2IDEzLjYwTDE5NS45MCAxMy42MFExOTcuMDQgMTMuNjAgMTk3Ljg4IDEzLjk4UTE5OC43MiAxNC4zNSAxOTkuMTcgMTUuMDZRMTk5LjYzIDE1Ljc2IDE5OS42MyAxNi43MUwxOTkuNjMgMTYuNzFRMTk5LjYzIDE3LjYyIDE5OS4yMCAxOC4zMFExOTguNzggMTguOTggMTk3Ljk5IDE5LjM2TDE5Ny45OSAxOS4zNkwxOTkuODAgMjJMMTk3LjI1IDIyTDE5NS43MyAxOS43N0wxOTQuNDMgMTkuNzdMMTk0LjQzIDIyWk0xOTQuNDMgMTUuNDdMMTk0LjQzIDE3LjkzTDE5NS43NSAxNy45M1ExOTYuNDkgMTcuOTMgMTk2Ljg2IDE3LjYxUTE5Ny4yMyAxNy4yOSAxOTcuMjMgMTYuNzFMMTk3LjIzIDE2LjcxUTE5Ny4yMyAxNi4xMiAxOTYuODYgMTUuNzlRMTk2LjQ5IDE1LjQ3IDE5NS43NSAxNS40N0wxOTUuNzUgMTUuNDdMMTk0LjQzIDE1LjQ3Wk0yMDMuOTkgMTcuODBMMjAzLjk5IDE3LjgwUTIwMy45OSAxNi41NCAyMDQuNTkgMTUuNTRRMjA1LjE5IDE0LjU1IDIwNi4yNCAxMy45OVEyMDcuMjkgMTMuNDMgMjA4LjYxIDEzLjQzTDIwOC42MSAxMy40M1EyMDkuNzYgMTMuNDMgMjEwLjY5IDEzLjg0UTIxMS42MSAxNC4yNSAyMTIuMjIgMTUuMDJMMjEyLjIyIDE1LjAyTDIxMC43MSAxNi4zOVEyMDkuOTAgMTUuNDAgMjA4LjczIDE1LjQwTDIwOC43MyAxNS40MFEyMDguMDUgMTUuNDAgMjA3LjUxIDE1LjcwUTIwNi45OCAxNiAyMDYuNjggMTYuNTRRMjA2LjM5IDE3LjA5IDIwNi4zOSAxNy44MEwyMDYuMzkgMTcuODBRMjA2LjM5IDE4LjUxIDIwNi42OCAxOS4wNVEyMDYuOTggMTkuNjAgMjA3LjUxIDE5LjkwUTIwOC4wNSAyMC4yMCAyMDguNzMgMjAuMjBMMjA4LjczIDIwLjIwUTIwOS45MCAyMC4yMCAyMTAuNzEgMTkuMjJMMjEwLjcxIDE5LjIyTDIxMi4yMiAyMC41OFEyMTEuNjEgMjEuMzUgMjEwLjY5IDIxLjc2UTIwOS43NiAyMi4xNyAyMDguNjEgMjIuMTdMMjA4LjYxIDIyLjE3UTIwNy4yOSAyMi4xNyAyMDYuMjQgMjEuNjFRMjA1LjE5IDIxLjA1IDIwNC41OSAyMC4wNVEyMDMuOTkgMTkuMDYgMjAzLjk5IDE3LjgwWk0yMTkuMTQgMjJMMjE2Ljc2IDIyTDIxNi43NiAxMy42MEwyMTkuMTQgMTMuNjBMMjE5LjE0IDE2Ljc2TDIyMi4zOCAxNi43NkwyMjIuMzggMTMuNjBMMjI0Ljc1IDEzLjYwTDIyNC43NSAyMkwyMjIuMzggMjJMMjIyLjM4IDE4LjcyTDIxOS4xNCAxOC43MkwyMTkuMTQgMjJaTTIzMS4zMyAyMkwyMjguOTEgMjJMMjMyLjYxIDEzLjYwTDIzNC45NiAxMy42MEwyMzguNjcgMjJMMjM2LjIxIDIyTDIzNS41NCAyMC4zN0wyMzEuOTkgMjAuMzdMMjMxLjMzIDIyWk0yMzMuNzcgMTUuOTNMMjMyLjY4IDE4LjYxTDIzNC44NSAxOC42MUwyMzMuNzcgMTUuOTNaTTI0NC42MiAxNS40OEwyNDIuMDQgMTUuNDhMMjQyLjA0IDEzLjYwTDI0OS41NiAxMy42MEwyNDkuNTYgMTUuNDhMMjQ2Ljk5IDE1LjQ4TDI0Ni45OSAyMkwyNDQuNjIgMjJMMjQ0LjYyIDE1LjQ4WiIgZmlsbD0iI0ZGRkZGRiIgeD0iMTU1LjYiLz48L3N2Zz4=) ![databricks](https://img.shields.io/badge/Databricks-FF3621.svg?style=for-the-badge&logo=Databricks&logoColor=white) [![forthebadge](data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDUuODgiIGhlaWdodD0iMzUiIHZpZXdCb3g9IjAgMCAxNDUuODggMzUiPjxyZWN0IGNsYXNzPSJzdmdfX3JlY3QiIHg9IjAiIHk9IjAiIHdpZHRoPSI4OC4wOCIgaGVpZ2h0PSIzNSIgZmlsbD0iIzAwMDAwMCIvPjxyZWN0IGNsYXNzPSJzdmdfX3JlY3QiIHg9Ijg2LjA4IiB5PSIwIiB3aWR0aD0iNTkuODAwMDAwMDAwMDAwMDEiIGhlaWdodD0iMzUiIGZpbGw9IiM1NTkzQzciLz48cGF0aCBjbGFzcz0ic3ZnX190ZXh0IiBkPSJNMTUuNzAgMjJMMTQuMjIgMjJMMTQuMjIgMTMuNDdMMTcuNDggMTMuNDdRMTguOTEgMTMuNDcgMTkuNzUgMTQuMjFRMjAuNTkgMTQuOTYgMjAuNTkgMTYuMThMMjAuNTkgMTYuMThRMjAuNTkgMTcuNDQgMTkuNzcgMTguMTNRMTguOTUgMTguODMgMTcuNDYgMTguODNMMTcuNDYgMTguODNMMTUuNzAgMTguODNMMTUuNzAgMjJaTTE1LjcwIDE0LjY2TDE1LjcwIDE3LjY0TDE3LjQ4IDE3LjY0UTE4LjI3IDE3LjY0IDE4LjY5IDE3LjI3UTE5LjEwIDE2LjkwIDE5LjEwIDE2LjE5TDE5LjEwIDE2LjE5UTE5LjEwIDE1LjUwIDE4LjY4IDE1LjA5UTE4LjI2IDE0LjY4IDE3LjUyIDE0LjY2TDE3LjUyIDE0LjY2TDE1LjcwIDE0LjY2Wk0yNi45MSAxOC44NkwyNC4wNSAxMy40N0wyNS43MCAxMy40N0wyNy42NiAxNy41MUwyOS42MiAxMy40N0wzMS4yNiAxMy40N0wyOC40MCAxOC44NkwyOC40MCAyMkwyNi45MSAyMkwyNi45MSAxOC44NlpNMzYuODYgMTQuNjZMMzQuMjIgMTQuNjZMMzQuMjIgMTMuNDdMNDAuOTkgMTMuNDdMNDAuOTkgMTQuNjZMMzguMzMgMTQuNjZMMzguMzMgMjJMMzYuODYgMjJMMzYuODYgMTQuNjZaTTQ2LjIzIDIyTDQ0Ljc0IDIyTDQ0Ljc0IDEzLjQ3TDQ2LjIzIDEzLjQ3TDQ2LjIzIDE3LjAyTDUwLjA0IDE3LjAyTDUwLjA0IDEzLjQ3TDUxLjUyIDEzLjQ3TDUxLjUyIDIyTDUwLjA0IDIyTDUwLjA0IDE4LjIxTDQ2LjIzIDE4LjIxTDQ2LjIzIDIyWk01NS45OSAxOC4wMEw1NS45OSAxOC4wMEw1NS45OSAxNy41MlE1NS45OSAxNi4yOCA1Ni40MyAxNS4zMlE1Ni44NyAxNC4zNyA1Ny42OCAxMy44NlE1OC40OCAxMy4zNSA1OS41MyAxMy4zNVE2MC41NyAxMy4zNSA2MS4zOCAxMy44NVE2Mi4xOCAxNC4zNSA2Mi42MiAxNS4yOVE2My4wNiAxNi4yMyA2My4wNyAxNy40OEw2My4wNyAxNy40OEw2My4wNyAxNy45NlE2My4wNyAxOS4yMSA2Mi42MyAyMC4xNlE2Mi4yMCAyMS4xMCA2MS4zOSAyMS42MVE2MC41OSAyMi4xMiA1OS41NCAyMi4xMkw1OS41NCAyMi4xMlE1OC41MCAyMi4xMiA1Ny42OSAyMS42MVE1Ni44OCAyMS4xMCA1Ni40NCAyMC4xN1E1NS45OSAxOS4yMyA1NS45OSAxOC4wMFpNNTcuNDcgMTcuNDZMNTcuNDcgMTcuOTZRNTcuNDcgMTkuMzYgNTguMDIgMjAuMTNRNTguNTcgMjAuOTAgNTkuNTQgMjAuOTBMNTkuNTQgMjAuOTBRNjAuNTIgMjAuOTAgNjEuMDUgMjAuMTVRNjEuNTggMTkuNDAgNjEuNTggMTcuOTZMNjEuNTggMTcuOTZMNjEuNTggMTcuNTFRNjEuNTggMTYuMDkgNjEuMDUgMTUuMzRRNjAuNTEgMTQuNTggNTkuNTMgMTQuNThMNTkuNTMgMTQuNThRNTguNTcgMTQuNTggNTguMDIgMTUuMzNRNTcuNDggMTYuMDkgNTcuNDcgMTcuNDZMNTcuNDcgMTcuNDZaTTY5LjAxIDIyTDY3LjUzIDIyTDY3LjUzIDEzLjQ3TDY5LjAxIDEzLjQ3TDcyLjgzIDE5LjU0TDcyLjgzIDEzLjQ3TDc0LjMwIDEzLjQ3TDc0LjMwIDIyTDcyLjgyIDIyTDY5LjAxIDE1Ljk1TDY5LjAxIDIyWiIgZmlsbD0iI0ZGRkZGRiIvPjxwYXRoIGNsYXNzPSJzdmdfX3RleHQiIGQ9Ik05OS4zOCAyMS4zNEw5OS4zOCAyMS4zNEwxMDAuMjQgMTkuNTVRMTAwLjc0IDE5Ljg4IDEwMS4zNSAyMC4wN1ExMDEuOTcgMjAuMjUgMTAyLjU4IDIwLjI1TDEwMi41OCAyMC4yNVExMDMuMTkgMjAuMjUgMTAzLjU1IDIwLjAyUTEwMy45MSAxOS43OSAxMDMuOTEgMTkuMzdMMTAzLjkxIDE5LjM3UTEwMy45MSAxOC41NSAxMDIuNjIgMTguNTVMMTAyLjYyIDE4LjU1TDEwMS42MyAxOC41NUwxMDEuNjMgMTcuMDVMMTAzLjEzIDE1LjQ0TDk5LjgyIDE1LjQ0TDk5LjgyIDEzLjYwTDEwNS44OSAxMy42MEwxMDUuODkgMTUuMDlMMTA0LjE1IDE2Ljk2UTEwNS4xOSAxNy4xOCAxMDUuNzUgMTcuODJRMTA2LjMxIDE4LjQ2IDEwNi4zMSAxOS4zN0wxMDYuMzEgMTkuMzdRMTA2LjMxIDIwLjExIDEwNS45MCAyMC43NVExMDUuNTAgMjEuMzkgMTA0LjY4IDIxLjc4UTEwMy44NiAyMi4xNyAxMDIuNjUgMjIuMTdMMTAyLjY1IDIyLjE3UTEwMS43NiAyMi4xNyAxMDAuODkgMjEuOTVRMTAwLjAyIDIxLjc0IDk5LjM4IDIxLjM0Wk0xMTAuNDcgMjAuNzVMMTEwLjQ3IDIwLjc1UTExMC40NyAyMC4xNSAxMTAuODYgMTkuNzhRMTExLjI1IDE5LjQxIDExMS44NCAxOS40MUwxMTEuODQgMTkuNDFRMTEyLjQ0IDE5LjQxIDExMi44MiAxOS43OFExMTMuMjEgMjAuMTUgMTEzLjIxIDIwLjc1TDExMy4yMSAyMC43NVExMTMuMjEgMjEuMzQgMTEyLjgyIDIxLjcyUTExMi40MyAyMi4xMSAxMTEuODQgMjIuMTFMMTExLjg0IDIyLjExUTExMS4yNiAyMi4xMSAxMTAuODYgMjEuNzJRMTEwLjQ3IDIxLjM0IDExMC40NyAyMC43NVpNMTE4LjY2IDE1LjQ0TDExNy4xMCAxNS40NEwxMTcuMTAgMTMuNjBMMTIxLjAzIDEzLjYwTDEyMS4wMyAyMkwxMTguNjYgMjJMMTE4LjY2IDE1LjQ0Wk0xMjUuNzggMTcuODBMMTI1Ljc4IDE3LjgwUTEyNS43OCAxNi40NSAxMjYuMjUgMTUuNDZRMTI2LjcyIDE0LjQ2IDEyNy41NiAxMy45NVExMjguNDAgMTMuNDMgMTI5LjQ4IDEzLjQzTDEyOS40OCAxMy40M1ExMzAuNTUgMTMuNDMgMTMxLjM5IDEzLjk1UTEzMi4yMyAxNC40NiAxMzIuNzEgMTUuNDZRMTMzLjE4IDE2LjQ1IDEzMy4xOCAxNy44MEwxMzMuMTggMTcuODBRMTMzLjE4IDE5LjE1IDEzMi43MSAyMC4xNVExMzIuMjMgMjEuMTQgMTMxLjM5IDIxLjY1UTEzMC41NSAyMi4xNyAxMjkuNDggMjIuMTdMMTI5LjQ4IDIyLjE3UTEyOC40MCAyMi4xNyAxMjcuNTYgMjEuNjVRMTI2LjcyIDIxLjE0IDEyNi4yNSAyMC4xNVExMjUuNzggMTkuMTYgMTI1Ljc4IDE3LjgwWk0xMjguMTYgMTcuODBMMTI4LjE2IDE3LjgwUTEyOC4xNiAxOS4wNiAxMjguNTIgMTkuNjRRMTI4Ljg3IDIwLjIyIDEyOS40OCAyMC4yMkwxMjkuNDggMjAuMjJRMTMwLjA5IDIwLjIyIDEzMC40NCAxOS42NFExMzAuODAgMTkuMDYgMTMwLjgwIDE3LjgwTDEzMC44MCAxNy44MFExMzAuODAgMTYuNTQgMTMwLjQ0IDE1Ljk2UTEzMC4wOSAxNS4zOCAxMjkuNDggMTUuMzhMMTI5LjQ4IDE1LjM4UTEyOC44NyAxNS4zOCAxMjguNTIgMTUuOTZRMTI4LjE2IDE2LjU0IDEyOC4xNiAxNy44MFoiIGZpbGw9IiNGRkZGRkYiIHg9Ijk5LjA4Ii8+PC9zdmc+)](https://forthebadge.com)

<p align="center">
<img src="https://github.com/rafaelvp-db/db-ancient-code-translation/blob/main/img/ancient_code.jpeg?raw=true" style="width: 50%"/>
</p>

<hr/>

## TLDR;

This repo demonstrates code translation (Code to Text, Code to Code) capabilities using Large Language Models (LLMs) on Databricks

## Getting Started

* Clone this repo into your Databricks Workspace
* Configure a Databricks single node cluster with [Databricks Runtime 13.2 for Machine Learning](https://docs.databricks.com/release-notes/runtime/13.2ml.html) and an [NVIDIA A100](https://www.nvidia.com/en-us/data-center/a100/) GPU ([A10](https://www.nvidia.com/en-us/data-center/products/a10-gpu/) might also work, though with lower floating point precision)
    * A100 Instances On Azure: `Standard_NC24ads_A100_v4` [instances](https://learn.microsoft.com/en-us/azure/virtual-machines/nc-a100-v4-series)
    * A100 Instances On AWS: `EC2 P4d` [instances](https://aws.amazon.com/ec2/instance-types/p4/#:~:text=P4d%20instances%20are%20powered%20by,support%20400%20Gbps%20instance%20networking.)
* Install the following libraries into the cluster (you can also do it directly in the notebooks and leverage `requirements.txt` for that):

```
accelerate==0.21.0
ninja
alibi
einops
transformers
triton
xformers
```

* Run the notebooks from the `notebooks` folder

## Authors

* [Rafael V. Pierre](https://github.com/rafaelvp-db/)
* [Andreas Jack](https://github.com/AndreasJaeck)

## Reference

* 💫 [StarCoder Github Project](https://github.com/bigcode-project/starcoder)
* Tunstall, Lewis and Lambert, Nathan and Rajani, Nazneen and Beeching, Edward and Le Scao, Teven and von Werra, Leandro and Han, Sheon and Schmid, Philipp and Rush, Alexander. [Creating a Coding Assistant with StarCoder](https://huggingface.co/blog/starchat). Hugging Face Blog, 2023.
* [Big Science Open RAIL-M License](https://www.licenses.ai/blog/2022/8/26/bigscience-open-rail-m-license)

## Appendix

### Evaluation
To evaluate StarCoder and its derivatives, you can use the [BigCode-Evaluation-Harness](https://github.com/bigcode-project/bigcode-evaluation-harness) for evaluating Code LLMs.
### Inference hardware requirements

In FP32 the model requires more than 60GB of RAM, you can load it in FP16 or BF16 in ~30GB, or in 8bit under 20GB of RAM with

```python
# make sure you have accelerate and bitsandbytes installed
from transformers import AutoModelForCausalLM, AutoTokenizer

tokenizer = AutoTokenizer.from_pretrained("bigcode/starcoder")
# for fp16 replace with  `load_in_8bit=True` with   `torch_dtype=torch.float16`
model = AutoModelForCausalLM.from_pretrained("bigcode/starcoder", device_map="auto", load_in_8bit=True)
print(f"Memory footprint: {model.get_memory_footprint() / 1e6:.2f} MB")
```

```
Memory footprint: 15939.61 MB
```
